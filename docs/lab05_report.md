# Лабораторная работа №5
## Вероятностные алгоритмы проверки чисел на простоту

### Цель работы
Реализация и исследование вероятностных алгоритмов проверки чисел на простоту:
1. Тест Ферма
2. Тест Соловэя-Штрассена  
3. Тест Миллера-Рабина

### Теоретическая часть

#### Основные определения
- **Простое число** - натуральное число, имеющее ровно два делителя: 1 и само число
- **Составное число** - натуральное число, имеющее более двух делителей
- **Вероятностный алгоритм** - алгоритм, использующий случайность и дающий правильный ответ с высокой вероятностью

#### Алгоритмы проверки простоты

##### Тест Ферма
Основан на малой теореме Ферма: если p - простое число, то для любого a, взаимно простого с p:
a^(p-1) ≡ 1 (mod p)

##### Тест Соловэя-Штрассена
Использует критерий Эйлера и символ Якоби. Для простого p и любого a:
a^((p-1)/2) ≡ (a/p) (mod p)

##### Тест Миллера-Рабина
Более мощный тест, основанный на разложении n-1 = 2^s * r и проверке последовательных возведений в квадрат.

### Практическая реализация

#### Структура программы
- `primality_tests.py` - основные алгоритмы проверки простоты
- `test_comprehensive.py` - расширенное тестирование и анализ

#### Результаты тестирования

##### Известные простые числа
Все три алгоритма корректно идентифицируют малые простые числа (5, 7, 11, 13, ...)

##### Известные составные числа  
Все алгоритмы корректно идентифицируют малые составные числа (9, 15, 21, 25, ...)

##### Числа Кармайкла
- Тест Ферма: часто ошибается, принимая числа Кармайкла за простые
- Тест Соловэя-Штрассена: более надежен, но также может ошибаться
- Тест Миллера-Рабина: наиболее надежен, правильно идентифицирует числа Кармайкла как составные

### Анализ вероятности ошибки

Вероятность ошибки после t итераций:
- Тест Ферма: ≤ 1/2^t (для большинства чисел)
- Тест Соловэя-Штрассена: ≤ 1/2^t
- Тест Миллера-Рабина: ≤ 1/4^t

### Выводы
1. Тест Миллера-Рабина является наиболее надежным из трех реализованных алгоритмов
2. Числа Кармайкла представляют наибольшую сложность для вероятностных тестов простоты
3. Увеличение количества итераций значительно снижает вероятность ошибки
4. Для криптографических применений рекомендуется использовать тест Миллера-Рабина с 20+ итерациями

### Использование программы
```bash
# Основное тестирование
python primality_tests.py

# Расширенное тестирование
python test_comprehensive.py